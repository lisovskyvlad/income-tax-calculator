(ns income-tax-calculator.core
  (:require [income-tax-calculator.germany :as ger]
            [income-tax-calculator.utils :refer [round2]]
            [clojure.pprint :as pp]))

(defn report-country [func income]
  (let [tax (round2 2 (func income))
        after-tax (round2 0 (- income tax))
        percent (round2 2 (* 100 (/ tax income)))
        per-month (round2 2 (/ after-tax 12))]
    {:tax tax
     :after-tax after-tax
     :percent percent
     :per-month-netto  per-month}))

(pp/print-table [:brutto :tax :after-tax :percent :per-month-netto]
                (map
                 #(into {:brutto %}
                         (report-country ger/income-tax %))
                 (range 10000 150000 3000)))

;; | :brutto |     :tax | :after-tax | :percent | :per-month-netto |
;; |---------+----------+------------+----------+------------------|
;; |   10000 |      0.0 |    10000.0 |      0.0 |           833.33 |
;; |   13000 |   335.73 |    12664.0 |     2.58 |          1055.33 |
;; |   16000 |   966.77 |    15033.0 |     6.04 |          1252.75 |
;; |   19000 |  1703.21 |    17297.0 |     8.96 |          1441.42 |
;; |   22000 |  2474.33 |    19526.0 |    11.25 |          1627.17 |
;; |   25000 |   3280.1 |    21720.0 |    13.12 |           1810.0 |
;; |   28000 |  4120.55 |    23879.0 |    14.72 |          1989.92 |
;; |   31000 |  4995.65 |    26004.0 |    16.11 |           2167.0 |
;; |   34000 |  5905.43 |    28095.0 |    17.37 |          2341.25 |
;; |   37000 |  6849.87 |    30150.0 |    18.51 |           2512.5 |
;; |   40000 |  7828.98 |    32171.0 |    19.57 |          2680.92 |
;; |   43000 |  8842.75 |    34157.0 |    20.56 |          2846.42 |
;; |   46000 |   9891.2 |    36109.0 |     21.5 |          3009.08 |
;; |   49000 |  10974.3 |    38026.0 |     22.4 |          3168.83 |
;; |   52000 | 12092.07 |    39908.0 |    23.25 |          3325.67 |
;; |   55000 | 13244.51 |    41755.0 |    24.08 |          3479.58 |
;; |   58000 | 14431.62 |    43568.0 |    24.88 |          3630.67 |
;; |   61000 | 15653.39 |    45347.0 |    25.66 |          3778.92 |
;; |   64000 | 16907.02 |    47093.0 |    26.42 |          3924.42 |
;; |   67000 | 18167.02 |    48833.0 |    27.11 |          4069.42 |
;; |   70000 | 19427.02 |    50573.0 |    27.75 |          4214.42 |
;; |   73000 | 20687.02 |    52313.0 |    28.34 |          4359.42 |
;; |   76000 | 21947.02 |    54053.0 |    28.88 |          4504.42 |
;; |   79000 | 23207.02 |    55793.0 |    29.38 |          4649.42 |
;; |   82000 | 24467.02 |    57533.0 |    29.84 |          4794.42 |
;; |   85000 | 25727.02 |    59273.0 |    30.27 |          4939.42 |
;; |   88000 | 26987.02 |    61013.0 |    30.67 |          5084.42 |
;; |   91000 | 28247.02 |    62753.0 |    31.04 |          5229.42 |
;; |   94000 | 29507.02 |    64493.0 |    31.39 |          5374.42 |
;; |   97000 | 30767.02 |    66233.0 |    31.72 |          5519.42 |
;; |  100000 | 32027.02 |    67973.0 |    32.03 |          5664.42 |
;; |  103000 | 33287.02 |    69713.0 |    32.32 |          5809.42 |
;; |  106000 | 34547.02 |    71453.0 |    32.59 |          5954.42 |
;; |  109000 | 35807.02 |    73193.0 |    32.85 |          6099.42 |
;; |  112000 | 37067.02 |    74933.0 |     33.1 |          6244.42 |
;; |  115000 | 38327.02 |    76673.0 |    33.33 |          6389.42 |
;; |  118000 | 39587.02 |    78413.0 |    33.55 |          6534.42 |
;; |  121000 | 40847.02 |    80153.0 |    33.76 |          6679.42 |
;; |  124000 | 42107.02 |    81893.0 |    33.96 |          6824.42 |
;; |  127000 | 43367.02 |    83633.0 |    34.15 |          6969.42 |
;; |  130000 | 44627.02 |    85373.0 |    34.33 |          7114.42 |
;; |  133000 | 45887.02 |    87113.0 |     34.5 |          7259.42 |
;; |  136000 | 47147.02 |    88853.0 |    34.67 |          7404.42 |
;; |  139000 | 48407.02 |    90593.0 |    34.83 |          7549.42 |
;; |  142000 | 49667.02 |    92333.0 |    34.98 |          7694.42 |
;; |  145000 | 50927.02 |    94073.0 |    35.12 |          7839.42 |
;; |  148000 | 52187.02 |    95813.0 |    35.26 |          7984.42 |
