(ns income-tax-calculator.core
  (:require [income-tax-calculator.spain :as sp]
            [income-tax-calculator.germany :as ger]
            [income-tax-calculator.utils :refer [round2]]))

(defn report-country [func income]
  (let [tax (round2 2 (func income))
        after-tax (round2 0 (- income tax))
        percent (round2 2 (* 100 (/ tax income)))]
    [tax after-tax percent]))

(map
  #(vector
     %
     (hash-map
       :spain (report-country sp/income-tax %)
       :germany (report-country ger/income-tax %)))
  (range 35000 120000 4000))
;; => ([35000 {:germany [6581.82 28418.0 18.81], :spain [8568.51 26431.0 24.48]}]
;;     [39000 {:germany [7905.16 31095.0 20.27], :spain [10041.51 28958.0 25.75]}]
;;     [43000 {:germany [9294.55 33705.0 21.62], :spain [11521.51 31478.0 26.79]}]
;;     [47000 {:germany [10750.01 36250.0 22.87], :spain [13001.51 33998.0 27.66]}]
;;     [51000 {:germany [12271.52 38728.0 24.06], :spain [14481.51 36518.0 28.4]}]
;;     [55000 {:germany [13859.09 41141.0 25.2], :spain [16041.16 38959.0 29.17]}]
;;     [59000 {:germany [15512.48 43488.0 26.29], :spain [17721.16 41279.0 30.04]}]
;;     [63000 {:germany [17192.48 45808.0 27.29], :spain [19521.16 43479.0 30.99]}]
;;     [67000 {:germany [18872.48 48128.0 28.17], :spain [21361.16 45639.0 31.88]}]
;;     [71000 {:germany [20552.48 50448.0 28.95], :spain [23201.16 47799.0 32.68]}]
;;     [75000 {:germany [22232.48 52768.0 29.64], :spain [25041.16 49959.0 33.39]}]
;;     [79000 {:germany [23912.48 55088.0 30.27], :spain [26881.16 52119.0 34.03]}]
;;     [83000 {:germany [25592.48 57408.0 30.83], :spain [28721.16 54279.0 34.6]}]
;;     [87000 {:germany [27272.48 59728.0 31.35], :spain [30561.16 56439.0 35.13]}]
;;     [91000 {:germany [28952.48 62048.0 31.82], :spain [32416.16 58584.0 35.62]}]
;;     [95000 {:germany [30632.48 64368.0 32.24], :spain [34316.16 60684.0 36.12]}]
;;     [99000 {:germany [32312.48 66688.0 32.64], :spain [36216.16 62784.0 36.58]}]
;;     [103000 {:germany [33992.48 69008.0 33.0], :spain [38116.16 64884.0 37.01]}]
;;     [107000 {:germany [35672.48 71328.0 33.34], :spain [40016.16 66984.0 37.4]}]
;;     [111000 {:germany [37352.48 73648.0 33.65], :spain [41916.16 69084.0 37.76]}]
;;     [115000 {:germany [39032.48 75968.0 33.94], :spain [43816.16 71184.0 38.1]}]
;;     [119000 {:germany [40712.48 78288.0 34.21], :spain [45716.16 73284.0 38.42]}])
